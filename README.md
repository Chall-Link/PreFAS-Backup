=================================================  
 
# Chall-Link「PreFAS Backup」『プリファス バックアップ』 - Precious Files Archive Script 
## 日本語版 Ver.1.0.0 
## VSS対応・貴重ファイル暗号化アーカイブスクリプト

`災害から貴重なファイルを守るため、大容量ドライブや大容量フォルダを7-ZipのAES-256暗号化で可搬性のあるアーカイブに変換し、クラウドやM-Disc（100年耐久光ディスク）に保存することをコンセプトに開発されたツールです`

**【著作権者】** Chall-Link（シャルリンク）  
**【開発地】** Developed in Japan  
**【ライセンス】** MIT License  
**【種別】** フリーソフトウェア（オープンソース）  

=================================================  
💡 本ドキュメントでは「アーカイブ」「バックアップ」「圧縮」をほぼ同じ意味として混在使用しています  
💡 「スナップショット」は「シャドーコピー」とも呼ばれます  

&emsp; 

---
## ■ファイル構成
PreFAS-Backup/  
├── ChaL-PreFAS-Backup-MAIN.bat&emsp;# 日本語版・メインスクリプト  
├── ChaL-PreFAS-Backup-MAIN-en.bat&emsp;# 英語版・メインスクリプト  
├── ChaL-PreFAS-Backup-SUB.bat&emsp;# 日本語版・サブスクリプト  
├── ChaL-PreFAS-Backup-SUB-en.bat&emsp;# 英語版・サブスクリプト  
├── README.md&emsp;# 日本語版・説明書  
├── README-en.md&emsp;# 英語版・説明書  
├── docs/  
│&emsp;&emsp;└── pdf/  
│&emsp;&emsp;&emsp;&emsp;├── README.pdf&emsp;# 日本語版・説明書 PDF  
│&emsp;&emsp;&emsp;&emsp;└── README-en.pdf&emsp;# 英語版・説明書 PDF  
├── PreFAS-Backup-OUTPUT-Folder-SAMPLE/&emsp;# サンプル出力フォルダ（デフォルト設定）
└── SAMPLE-SOURCE-Folder-PreFAS-Backup/&emsp;# サンプルソースフォルダ（約2MB）（デフォルト設定）
 

> ### 🚀 すぐに試せます！
> デフォルト設定でスクリプトをすぐ試せるように、`ChaL-PreFAS-Backup-MAIN.bat`を管理者権限で実行し、パスワード入力すると、
> `SAMPLE-SOURCE-Folder-PreFAS-Backup`を、`PreFAS-Backup-OUTPUT-Folder-SAMPLE` にアーカイブファイルを作成できるようになています。動作チェックなどにご利用にご活用ください。


> 拡張子 `.md` はマークダウンファイルです。GitHub上では自動的に見やすく表示されます。  
> ローカルで読みにくい場合は、`docs/pdf/` の PDF ファイルをご利用ください。

&emsp; 

---
## ■概要：画期的な特徴

### ■概要
TB（テラバイト）規模のドライブやフォルダでも、7-ZipによりAES256で強力に暗号化して圧縮ファイルにし、長期的に安全に保存する事を可能にするスクリプトです。
また、姉妹ソフト Chall-Link「VSSDetector」により、WindowsのVSS 復元ポイント＝スナップショットを活用したバックアップが可能になり、それによりバックアップ処理中でも元フォルダで作業を継続できます。

### ■本スクリプトが解決する課題
想い出の写真、プログラムファイル、設計図、芸術作品、アイデアなど、家庭や事務所のPCだけに保存している貴重なファイルは、不意の災害（地震、津波、火災、落雷、盗難など）によって一瞬で失われるリスクがあります。
防災意識が高まる昨今、大切なファイルを一カ所にだけ保存する事は、長期安全保管の観点からは全く無防備と言わざるを得ません。

&emsp; 

---
## ■大切なファイルが災害などで紛失しないようにするアイデア

### ■考案したファイル長期安全保護アイデア

- **対象**: 大切なファイルが含まれるTB（テラバイト）規模の大容量ドライブや大容量フォルダ  
- **手段**: PreFAS Backupによる次の条件でのアーカイブ化  
  - 25GB分割
  - AES-256暗号化
  - **運用** (PreFAS Backup コアコンセプト)  
    - **提案1**: 光ディスクでの遠隔地物理保管（M-Disc: 100年耐久性（推奨）/ 一般的なDVD・BD: 20年以内）
    - **提案2**: クラウドストレージでのオンライン保存

 ### ■このアイデアの効果
- **ファイル紛失リスクの大幅低減**: 遠隔地への分散保存により災害などによるファイル紛失リスクを大幅に減らす事が可能
- **情報漏洩セキュリティ**: 20～30桁のランダムな英数記号パスワードの組み合わせによるAES-256暗号化アーカイブは現代の技術ではほぼ解読不可能。パスワードを漏洩しない限りファイル内容の漏洩リスクは限りなく低い。

`これが、Chall-Link「PreFAS Backup」のコアコンセプトであり、PreFAS Backupが提供するソリューションです。`  

### ■Chall-Link「PreFAS Backup」／ シャルリンク「プリファス バックアップ」
Chall-Link「PreFAS Backup」は、このアイデアを最適な形で実行するための7-Zip機能拡張スクリプトです。
PreFASは、「**Pre** cious **F**iles **A**rchive **S**cript」  
すなわち「貴重ファイルのアーカイブスクリプト」から命名されています。

&emsp; 

---
## ■PreFAS Backupの特徴／他ソフトに対する優位性
### ■特徴
- 独立したアーカイブファイル：作成されたファイルは通常ファイルとしてエクスプローラーで自由にコピーや移動が可能  
- 大規模容量対応：TB（テラバイト）規模のフォルダ/ドライブでも全自動でバックアップ  
- VSS対応：姉妹ソフトChall-Link「VSSDetector」と併用すれば、Windows復元ポイントのスナップショットをバックアップソースとする事で、バックアップ中に元フォルダでの作業を継続可能に。
- 処理中の快適なPC作業環境：7-ZipのCPU負荷を制御することで、バックアップ中でもソースフォルダでの編集作業を快適に実行する事を実現  
- 情報漏洩セキュリティ：AES-256暗号化でデータを強力に保護 
- 光ディスク保存に最適化：25GB、50GB、100GBの光ディスクへの保存を想定した効率的なデフォルト分割サイズ設定 (25GBの光ディスクに、本ファイル＋同梱ファイル（約300MB）を保存できるよう分割サイズを設定（変更可）） 
- カスタマイズ性：スクリプトに設定を直接記述し、繰り返し利用可能なカスタムバックアップを実現。スクリプト内にコメントメモを記入する事も可能  
- プロ品質の信頼性：市販ソフト並みのエラーハンドリングシステム
- 高度なアーカイブ制御：7-ZipのGUIでは利用できない詳細な制御パラメータを活用可能  

### ■一般的な市販バックアップソフトに対する優位性

- **長期保存後の復元可能性の高さ**
    **市販ソフトの問題**: 例えば5年後にバージョンアップを繰返し、過去のバックアップが開けなくなるリスクがあります  
    **PreFAS Backupの利点**: 標準的な7-Zip形式なので10年後であっても復元できる可能性が高くなります

- **プログラムの安定性**  
    **市販ソフトの問題**: 複雑な構造なのでPC環境によって非常に動作が重いなどの動作が不安定になるリスクがあります  
    **PreFAS Backupの利点**: シンプル設計なので、PC環境によらず快適に安定動作する可能性が高くなります  

- **コピー・移動などのファイル操作の自由度**
    **市販ソフトの問題**: ソフト管理下でしかバックアップファイルを扱えず、エクスプローラーで移動・コピーすると動作保証外の物もあります  
    **PreFAS Backupの利点**: 普通のファイルとして、エクスプローラーで自由にコピー・移動、クラウド、光ディスクへの保存が可能です

&nbsp;

---
## ■動作環境
### ■動作環境
- **ダウンロードリンク**:  [PreFAS Backup-GitHub Release](https://github.com/Chall-Link/PreFAS-Backup/releases) 掲載の「Source code (zip)」をダウンロードしてください。GitHubのRawダウンロードでダウンロードすると改行コードがLFになり動作しませんのでご注意ください。  
- **文字コード・改行コード**: 本スクリプトは日本語対応のWindowsスクリプトで、Shift-JISエンコーディングとCRLF改行コードでなければ正常に動作しません。  
- **必須ソフト**: 7-Zip（LGPLライセンス）が必要（[https://www.7-zip.org/](https://www.7-zip.org/) から入手）  
- **Windows10 Pro 64bit**: （動作確認済み）、理論上はWindows7 SP1以上で動作可能（未確認のため自己責任でテスト推奨）  
- **必要条件**: PowerShell 2.0以上（Windows標準搭載）、管理者権限  
- **VSSスナップショットをアーカイブソースにする場合**: Chall-Link「VSSDetector」（ [VSSDetector-GitHub Release](https://github.com/Chall-Link/VSSDetector/releases)から入手）
- ドライブ丸ごとアーカイブ可能ですが、本スクリプトはデータのアーカイブツールのため、システムドライブ（C:）をアーカイブして復元してもOSとしては機能しません。

&emsp; 

### ■スクリプト利用時に「WindowsによってPCが保護されました」が出た場合
初回利用時にWindows Defender SmartScreenが警告を表示する場合があります。これは署名されていない新しいソフトウェアに対する標準的な警告です。

**安全性について：**
- ESETウイルススキャン（ローカル確認済み）
- 完全オープンソース（内容確認可能）

**実行方法：** 警告画面で「詳細情報」→「実行」をクリック

&emsp; 

---
## ■使用前に必ずお読み下さい

- 全ての対象ファイルを残さずバックアップできるように PreFAS-Main.batの実行は管理者権限を必要としています。
- 本スクリプトは長時間の実行を想定しておりCPUに高負荷がかかり続けないよう制御していますが、それでも使用中にPCファンが通常より高速回転し続ける音がするなど、異常と思われる状況を確認しましたら必ず使用の中止を検討して下さい。
- 圧縮ファイル名、対象フォルダ、出力フォルダなど、**全て英数半角のみ使用してください。**

&emsp; 

---
## ■PreFAS Backupによる大容量ドライブ、大容量フォルダ暗号化バックアップの活用シーン
- **クリエイター**: 作品の作業ファイル、完成作品ファイルなど
- **開発者**: 作業中のプログラムファイル、完成プログラムファイルなど
- **フォトグラファー**: 写真画像ファイル・動画映像ファイルなど
- **事業者**: 契約書ファイル、業務ファイルなど

&emsp; 

---
## ■使い方
### ■概略
PreFAS-Sub.bat を開き、変数にアーカイブソースのパス、出力先フォルダのパスなどを設定し、
PreFAS-Main.batを管理者権限で実行すると、自動的にPreFAS-Sub.batが実行されます。MainからSubを実行する事で、7-ZipによりCPUが過負荷にならないようWindows上でのスクリプトの処理優先度を制御しています。
### ■通常のバックアップの場合
1. PreFAS-Sub.batを開いて、【設定必須】変数グループＡの変数を確認・編集して下さい。編集方法の説明は、PreFAS-Sub.bat内に解説があります。
   **【設定必須】変数グループＡ**:
   - (A-1) 7-Zipインストールパスの設定
   - (A-2) アーカイブファイル名
   - (A-3) アーカイブする対象ソースフォルダ
   - (A-4) 7zipアーカイブ出力フォルダ
   - (A-5) 除外ファイル、除外フォルダ
2. 必要に応じて下記変数グループを修正します。
   - 【確認と必要に応じて修正】変数グループＢ
   - 【状況に応じて修正】変数グループＣ
3. PreFAS-Main.batを右クリックして、「管理者として実行」からスクリプトを実行します。
4. 圧縮ファイルに設定するパスワードを2回入力します。
   （推奨：20～30桁のランダムな英数記号 - 現代技術ではまず破られません）
5. 圧縮が終了するまでお待ちください。作業中のコマンドウィンドウを間違って閉じないよう、ウィンドウ背景を水色にしています。

&emsp; 

### ■高度な実行オプション：VSSDetectorを使ってVSS機能を使用する場合（バックアップ中も作業継続可能）

> 詳細は、Chall-Link「VSSDetector」のREADME.md 、advanced-backup-guide.mdをご確認ください。
1. ChaL-VSSDetectorフォルダ内の「ChaL-VSSDetector.bat」を管理者権限で実行
2. 表示されるスナップショット一覧から、使用したいものを選択。結果は「ChaL-RESULT-VSSDetector.txt」に保存されます
3. 表示されたVSSパス（例: `\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*`）をPreFAS-Sub.batの「アーカイブする対象ソースフォルダ」に設定
4. 上記「通常のバックアップ」の手順(3)以降を実行
**👉 これで、バックアップ処理中でも元のファイル・フォルダで作業を続けることができます！**

&emsp; 

---
## ■エラー発生時の対処

- 背景色が水色から黄色に変わったり「Everything is Ok」が表示されないなど、エラーが発生した場合、出力フォルダ内のエラーログ「Results_PreFAS_ERROR_*.log」を確認してください。
- 7-Zipが未インストールの場合は、[https://www.7-zip.org/](https://www.7-zip.org/)から7-Zipを入手しインストールし、PreFAS-Sub.batの【設定必須】変数グループＡの(A-1)の内容を見直してください。
- フォルダ設定に問題があった場合は、PreFAS-Sub.batの【設定必須】変数グループＡの(A-3)(A-4)の設定を見直して下さい。

&emsp; 

---
## ■著作権・免責事項

本ソフトウェアはフリーソフトウェア（MITライセンス）です。著作権はChall-Linkに帰属します。本ツールは7-Zip（LGPLライセンス）を使用します。7-Zipの詳細については[https://www.7-zip.org/](https://www.7-zip.org/)をご参照ください。

本スクリプトの使用による損害や障害について、著作者は一切の責任を負いません。スクリプトのコアロジックを保持する場合、通信や個人的な手渡しによる転載・配布は自由ですが、出典として「Chall-Link」を明記してください。悪意ある使用や改変は禁止です。

ご意見・ご感想はGitHubリポジトリの [Issues](https://github.com/Chall-Link/PreFAS-Backup/issues) にてお願いします。
コードレビューや改善提案も歓迎いたします。  
ただし個別サポートや返信は行っておりません。  

&emsp; 

---
## ■タグ
バックアップ, 災害対策, データ保護, 暗号化, 7zip, アーカイブ, ファイルセキュリティ, クラウド保存, M-Disc, VSS, Volume Shadow Copy  
[Tags: backup, disaster-recovery, data-protection, encryption, 7zip, archive, file-security, cloud-storage, M-Disc, VSS, volume-shadow-copy]

&emsp; 

以上
